<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Visitas</title>
    <link rel="stylesheet" href="css/styles.css">
</head>
<body>
    <div class="barra-superior"></div>
    <div class="container">
        <header>
            <h1> Visita Segura Duoc Uc</h1>
            <div class="status-area">
                <div class="status" id="status">Conectado </div>
                <div class="session-controls">
                    <button id="btnChangePass" class="btn btn-secondary">Cambiar contrase√±a</button>
                    <button id="btnLogout" class="btn btn-warning">Cerrar sesi√≥n</button>
                </div>
            </div>
        </header>

        <main>
            <!-- Secci√≥n de registro -->
            <section class="card">
                <h2> Registrar Visita</h2>
                <form id="formIngreso" class="form">
                    <div class="form-group">
                        <label for="rut">RUT:</label>
                        <input type="text" id="rut" placeholder="12345678-9" required>
                    </div>
                    <div class="form-group">
                        <label for="nombre">Nombre completo:</label>
                        <input type="text" id="nombre" placeholder="Juan P√©rez" required>
                    </div>
                    <div class="form-group">
                        <label for="areaSelect">√Årea:</label>
                        <!-- Mantener select para compatibilidad con el c√≥digo existente (oculto) -->
                        <select id="areaSelect" required style="display:none;">
                            <option value="" disabled selected>Seleccione un √°rea</option>
                        </select>

                        <!-- Bot√≥n visible que abre un modal con opciones grandes -->
                        <div class="area-picker-wrapper">
                            <button id="areaPickerBtn" type="button" class="btn btn-input">
                                <span class="area-picker-text">Seleccione un √°rea</span>
                                <span class="area-picker-arrow">‚ñæ</span>
                            </button>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary"> Registrar Ingreso</button>
                </form>
            </section>

            <!-- Secci√≥n de b√∫squeda y acciones -->
            <section class="card">
                <h2> Acciones R√°pidas</h2>
                <div class="actions">
                    <button id="btnVisitas" class="btn btn-info"> Ver Todas las Visitas</button>
                    <button id="btnBuscar" class="btn btn-info"> Buscar por RUT</button>
                    <button id="btnReportes" class="btn btn-secondary"> Ver Reportes</button>
                    <button id="btnReporte" class="btn btn-success"> Generar Reporte</button>
                    <button id="btnScanner" class="btn btn-primary"> Usar Esc√°ner M√≥vil</button>
                    <button id="btnLimpiar" class="btn btn-warning"> Limpiar Resultados</button>
                </div>
                
                <div class="search-section" id="searchSection" style="display: none;">
                    <div class="form-group">
                        <label for="rutBuscar">RUT a buscar:</label>
                        <input type="text" id="rutBuscar" placeholder="12345678-9">
                    </div>
                    <button id="btnBuscarRut" class="btn btn-info"> Buscar</button>
                </div>
            </section>

            <!-- Resultados -->
            <section class="card">
                <h2> Resultados</h2>
                <div id="loading" class="loading" style="display: none;">Cargando...</div>
                <div id="resultado" class="resultado"></div>
            </section>
        </main>

        <footer>
            <p>Sistema de Registro de Visitas v1.0.0</p>
        </footer>
    </div>

    <!-- Modal para seleccionar √°reas -->
    <div id="areaModal" class="area-modal" aria-hidden="true">
        <div class="area-modal-overlay" id="areaModalOverlay"></div>
        <div class="area-modal-content" role="dialog" aria-modal="true" aria-labelledby="areaModalTitle">
            <button id="areaModalClose" class="area-modal-close" aria-label="Cerrar">‚úï</button>
            <h3 id="areaModalTitle">Seleccionar √Årea</h3>
            <p class="area-modal-sub">Elige un √°rea grande y f√°cil de pulsar</p>
            <div id="areaGrid" class="area-grid" tabindex="0">
                <!-- Tiles de √°reas ser√°n cargados din√°micamente -->
            </div>
            <div class="area-modal-actions">
                <button id="areaCloseBtn" class="btn btn-primary">Cerrar</button>
            </div>
        </div>
    </div>

    <!-- Modal: Cambiar contrase√±a -->
    <div id="changePassModal" class="changepass-modal" aria-hidden="true">
        <div class="changepass-overlay" id="changePassOverlay"></div>
        <div class="changepass-content" role="dialog" aria-modal="true" aria-labelledby="changePassTitle">
            <button id="changePassClose" class="area-modal-close" aria-label="Cerrar">‚úï</button>
            <h3 id="changePassTitle">Cambiar contrase√±a</h3>
            <p class="area-modal-sub">Aqu√≠ puedes cambiar tu contrase√±a. Los administradores pueden cambiar contrase√±as de cualquier usuario.</p>

            <div class="form-group">
                <label for="changeUser">Usuario (solo Admin):</label>
                <select id="changeUser">
                    <option value="">(Usa tu usuario para cambiar tu propia contrase√±a)</option>
                </select>
            </div>

            <!-- Not required: only admin can change passwords -->

            <div class="form-group">
                <label for="newPassword">Nueva contrase√±a:</label>
                <input type="password" id="newPassword" placeholder="Nueva contrase√±a" />
            </div>

            <div class="form-group">
                <label for="confirmPassword">Confirmar nueva contrase√±a:</label>
                <input type="password" id="confirmPassword" placeholder="Confirmar nueva contrase√±a" />
            </div>

            <div class="area-modal-actions">
                <button id="changePassSubmit" class="btn btn-primary">Cambiar</button>
                <button id="changePassCancel" class="btn btn-secondary">Cancelar</button>
            </div>
        </div>
    </div>

    <!-- Modal de selecci√≥n de perfil (login) -->
    <div id="loginModal" class="login-modal" aria-hidden="true">
        <div class="login-modal-overlay" id="loginModalOverlay"></div>
        <div class="login-modal-content" role="dialog" aria-modal="true" aria-labelledby="loginModalTitle">
            <h3 id="loginModalTitle">Seleccionar Perfil</h3>
            <p class="login-modal-sub">Elige tu perfil e ingresa la contrase√±a</p>

            <div class="profiles-row">
                <button type="button" class="profile-btn" data-username="guardia" id="profileGuardia">Guardia</button>
                <button type="button" class="profile-btn" data-username="admin" id="profileAdmin">üîë Administrador</button>
            </div>

            <div class="form-group login-pass">
                <label for="loginPassword">Contrase√±a:</label>
                <input type="password" id="loginPassword" placeholder="Contrase√±a" />
            </div>

            <div class="login-actions">
                <button id="loginSubmit" class="btn btn-primary">Iniciar sesi√≥n</button>
            </div>
        </div>
    </div>

    <script src="js/app.js"></script>
</body>
</html>